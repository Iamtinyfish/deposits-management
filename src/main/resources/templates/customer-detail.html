<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
	<th:block th:insert="~{/common/_layout::metadata('Hồ sơ khách hàng')}" />
	<style>
		.border-table,
		.border-table th,
		.border-table td {
			border: 1px solid black;
		}
	</style>
</head>

<body>
	<th:block th:insert="~{/common/_layout::navbar}" />
	<div class="background"></div>
	<div class="frames d-flex mt-4">

		<div class="create-form mr-4">
			<h2 class="title mb-4">Hồ sơ khách hàng</h2>
			<form method="post" th:action="@{/user/customer/update}" th:object="${customer}">

				<input hidden th:field="*{id}">

				<div class="title d-flex">
					Mã khách hàng :
					<p th:text="*{id}" class="ml-1"></p>
				</div>

				<th:block th:insert="~{/common/_customer::customer-input-form}" />



				<div class="title d-flex text-center ">
					<div class="d-flex" style="margin-right: 11.5rem;">
						<p  id="create-date"><input th:value="*{createdAt}" id="create-at" class="btn" type="hidden" />
						</p>
					</div>
					<div class="d-flex mr-4">
						<p  id="update-date"><input type="hidden" th:value="*{lastModifiedAt}" id="edit-at" class="btn"
								disabled /></p>
					</div>

				</div>

				<div class="title d-flex ">
					Sửa lần cuối bởi nhân viên có mã :
					<p th:text="*{ lastModifiedBy.id}" class="ml-1"></p>
				</div>

				<input id="updateBtn" th:hidden="${readOnly == true}" type="submit" class="btn btn-success"
					value="Update" />

				<button id="cancelBtn" th:hidden="${readOnly == true}" type="button" class="btn btn-secondary ml-4"
					value="Cancel">Cancel</button>

				<button id="editBtn" th:hidden="${readOnly == false}" type="button"
					class="btn btn-warning">Edit</button>

			</form>
		</div>

		<div class="create-form ml-4">
			<h2 class="title mb-4">Tài khoản tiền gửi</h2>
			<a th:href="@{'/user/deposit-account/add?customerID=' + ${customer.id}}" class="btn btn-success mb-4">Thêm
				tài khoản tiền gửi mới</a>

			<table class="table-bordered table table-hover title title-table">
				<thead>
					<tr class="table-active">
						<th scope="col">Số tài khoản</th>
						<th scope="col">Số dư</th>
						<th scope="col">Loại</th>
						<th scope="col"></th>
					</tr >
				</thead>
				<tbody>
					<tr th:each="depositAccount : ${customer.depositAccountSet}">
						<td  th:text="${depositAccount.id}"></td >
						<td id="surplus" th:text="${depositAccount.balance}"></td >
						<td
							th:text="${depositAccount.period == 0 ? 'Không kì hạn' : ('Có kì hạn: ' + depositAccount.period + ' tháng')}">
						</td>
						<td><a th:href="@{'/user/deposit-account/detail?depositAccountID=' + ${depositAccount.id}}">Chi
								tiết</a></td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	</div>
	<script th:inline="javascript">
		/*<![CDATA[*/
		const allInputElements = document.getElementsByTagName("input");
		const editBtn = document.getElementById("editBtn");
		const updateBtn = document.getElementById("updateBtn");
		const cancelBtn = document.getElementById("cancelBtn");
		const createInput = document.getElementById("create-at");
		const updateInput = document.getElementById("edit-at");
		const createText = document.getElementById("create-date");
		const updateText = document.getElementById("update-date");
		const surplus = document.getElementById("surplus");
		console.log(surplus.innerText)

		createText.innerHTML = 'Ngày tạo : ' +  new Date(createInput.value).toLocaleDateString("vn-VN")
		
		updateText.innerHTML = 'Ngày sửa lần cuối : ' +  new Date(updateInput.value).toLocaleDateString("vn-VN")
		
		surplus.innerHTML = Number(surplus.innerText).toLocaleString('it-IT', {style : 'currency', currency : 'VND'});
	
	
	
		editBtn.onclick = () => {
			for (const inputElement of allInputElements) {
				inputElement.readOnly = false;
				updateBtn.hidden = false;
				cancelBtn.hidden = false;
				editBtn.hidden = true;
			}
		};

		cancelBtn.onclick = () => {
			for (const inputElement of allInputElements) {
				inputElement.readOnly = true;
				updateBtn.hidden = true;
				cancelBtn.hidden = true;
				editBtn.hidden = false;
			}
		};

		/*]]>*/
	</script>

	<th:block th:insert="~{/common/_layout::js-lib}" />
</body>

</html>